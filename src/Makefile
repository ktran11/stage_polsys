CFLAGS = -std=c11 -Wall -Wextra
CPPFLAGS = -I/usr/local/include/flint -I/usr/local/include/ -I../include
LDFLAGS = -L/usr/local/lib -lflint -lgmp -lmpfr -lpthread

all: test test_m_basis

test: main.o m_basis.o basis.o matpol.o nmod_list_poly_mat.o perm_operator.o left_nullspace.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

test_m_basis: m_basis_test.o m_basis.o basis.o matpol.o nmod_list_poly_mat.o perm_operator.o left_nullspace.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

test_m_basis.o: m_basis_test.c

main.o: main.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $< 	

nmod_list_poly_mat.o: nmod_list_poly_mat.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $<

perm_operator.o: perm_operator.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $<

matpol.o: matpol.c 
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $< 

basis.o: basis.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $< 

m_basis.o: m_basis.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $< 

left_nullspace.o: left_nullspace.c
	$(CC) $(CFLAGS) $(LDFLAGS) $(CPPFLAGS) -c $< 

clean:
	@rm -f *~ *.o test 
help:
	@echo "Usage:"
	@echo "  make [all] \t\t Run the whole build of matpol"
	@echo "  make matpol \t\t Build the executable file from matpol.c"
	@echo "  make clean \t\t Remove all files generated by make"
	@echo "  make help \t\t Display this help"

.PHONY: all clean help
